<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACME Package Registry</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Skip to main content link for keyboard users -->
    <a href="#main-content" class="skip-link">Skip to main content</a>

    <!-- Hidden API Configuration -->
    <input type="hidden" id="apiBaseUrl" value="">
    <input type="hidden" id="authToken" value="">

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ACME Package Registry</h1>
            <p class="subtitle">Trustworthy Model, Dataset & Code Repository</p>
            <nav class="header-buttons" aria-label="Main navigation">
                <button onclick="goToHealthDashboard()" class="health-btn" aria-label="View health dashboard">
                    <span aria-hidden="true">ðŸ“Š</span> Health Dashboard
                </button>
                <button onclick="logout()" class="logout-btn" aria-label="Log out of application">Logout</button>
            </nav>
        </header>

        <!-- Search and Actions Bar -->
        <div class="actions-bar">
            <search class="search-container" role="search" aria-label="Search artifacts">
                <label for="search-input" class="visually-hidden">Search by name or ID</label>
                <input
                    type="search"
                    id="search-input"
                    placeholder="Search by name or ID"
                    class="search-input"
                    aria-label="Search by name or ID"
                >
                <button onclick="searchArtifacts()" class="search-btn">Search</button>
            </search>
            <div class="action-buttons">
                <button onclick="showRegisterModal()" class="add-btn" id="register-user-btn" style="display: none;" aria-label="Register a new user">+ Register User</button>
                <button onclick="showAddArtifactModal()" class="add-btn" aria-label="Add a new artifact">+ Add Artifact</button>
            </div>
        </div>

        <!-- Main Content Area -->
        <main id="main-content">
            <!-- Loading State -->
            <div id="loading" class="loading-state" style="display: none;" role="status" aria-live="polite">
                <div class="spinner" aria-hidden="true"></div>
                <p>Loading artifacts...</p>
            </div>

            <!-- Error State -->
            <div id="error-state" class="error-state" style="display: none;" role="alert" aria-live="assertive">
                <p id="error-message"></p>
            </div>

            <!-- Empty State -->
            <div id="empty-state" class="empty-state" style="display: none;">
                <h2>No artifacts found</h2>
                <p>Get started by adding your first artifact!</p>
            </div>

            <!-- Artifacts Grid -->
            <div id="artifacts-grid" class="artifacts-grid" role="list" aria-label="Artifacts">
                <!-- Cards will be populated here by JavaScript -->
            </div>
        </main>

        <!-- Pagination -->
        <nav id="pagination" class="pagination" style="display: none;" aria-label="Pagination navigation">
            <button onclick="loadPage('prev')" id="prev-btn" class="pagination-btn" disabled aria-label="Go to previous page">Previous</button>
            <span id="page-info" aria-live="polite" aria-atomic="true">Page 1</span>
            <button onclick="loadPage('next')" id="next-btn" class="pagination-btn" aria-label="Go to next page">Next</button>
        </nav>
    </div>

    <!-- Add Artifact Modal -->
    <div id="add-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="add-modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="add-modal-title">Add New Artifact</h2>
                <button onclick="closeAddModal()" class="close-btn" aria-label="Close dialog">&times;</button>
            </div>
            <div class="modal-body">
                <form id="add-artifact-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="artifact-type">Artifact Type: <span class="required" aria-label="required">*</span></label>
                        <select id="artifact-type" class="input-field" required aria-required="true">
                            <option value="model">Model</option>
                            <option value="dataset">Dataset</option>
                            <option value="code">Code</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="artifact-url">URL: <span class="required" aria-label="required">*</span></label>
                        <input
                            type="url"
                            id="artifact-url"
                            class="input-field"
                            placeholder="https://huggingface.co/google-bert/bert-base-uncased"
                            required
                            aria-required="true"
                            aria-describedby="url-help"
                        >
                        <span id="url-help" class="form-help visually-hidden">Enter a valid HuggingFace URL for the artifact</span>
                    </div>
                    <div id="add-error" class="modal-error" style="display: none;" role="alert" aria-live="assertive"></div>
                    <div id="add-success" class="modal-success" style="display: none;" role="status" aria-live="polite"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button onclick="closeAddModal()" class="btn-secondary">Cancel</button>
                <button onclick="createArtifact()" class="btn-primary" id="submit-btn">Add Artifact</button>
            </div>
        </div>
    </div>

    <!-- Artifact Detail Modal -->
    <div id="detail-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="detail-name">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="detail-name">Artifact Details</h2>
                <button onclick="closeDetailModal()" class="close-btn" aria-label="Close dialog">&times;</button>
            </div>
            <div class="modal-body">
                <dl class="detail-list">
                    <div class="detail-row">
                        <dt class="detail-label">Type:</dt>
                        <dd id="detail-type" class="badge"></dd>
                    </div>
                    <div class="detail-row">
                        <dt class="detail-label">ID:</dt>
                        <dd id="detail-id"></dd>
                    </div>
                    <div class="detail-row">
                        <dt class="detail-label">Source URL:</dt>
                        <dd><a id="detail-url" href="#" target="_blank" rel="noopener noreferrer" class="detail-link" aria-label="Open artifact source URL in new tab"></a></dd>
                    </div>
                    <div class="detail-row">
                        <dt class="detail-label">Quality Score:</dt>
                        <dd>
                            <div class="score-container">
                                <div class="score-bar" role="progressbar" aria-valuemin="0" aria-valuemax="1" aria-valuenow="0" aria-labelledby="detail-score-text">
                                    <div id="detail-score-fill" class="score-fill"></div>
                                </div>
                                <span id="detail-score-text" class="score-text"></span>
                            </div>
                        </dd>
                    </div>
                </dl>
            </div>
            <div class="modal-footer">
                <button onclick="closeDetailModal()" class="btn-primary">Close</button>
            </div>
        </div>
    </div>

    <!-- Register User Modal -->
    <div id="register-modal" class="modal" style="display: none;" role="dialog" aria-modal="true" aria-labelledby="register-modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="register-modal-title">Register New User</h2>
                <button onclick="closeRegisterModal()" class="close-btn" aria-label="Close dialog">&times;</button>
            </div>
            <div class="modal-body">
                <form id="register-user-form" onsubmit="return false;">
                    <div class="form-group">
                        <label for="register-username">Username <span class="required" aria-label="required">*</span></label>
                        <input type="text" id="register-username" class="input-field" placeholder="Enter username" required aria-required="true">
                    </div>
                    <div class="form-group">
                        <label for="register-password">Password <span class="required" aria-label="required">*</span></label>
                        <input type="password" id="register-password" class="input-field" placeholder="Minimum 8 characters" required aria-required="true" aria-describedby="password-help">
                        <span id="password-help" class="form-help visually-hidden">Password must be at least 8 characters long</span>
                    </div>
                    <div class="form-group">
                        <label for="register-confirm-password">Confirm Password <span class="required" aria-label="required">*</span></label>
                        <input type="password" id="register-confirm-password" class="input-field" placeholder="Re-enter password" required aria-required="true">
                    </div>
                    <fieldset class="form-group">
                        <legend>Permissions</legend>
                        <div class="checkbox-group">
                            <label>
                                <input type="checkbox" id="register-can-upload" aria-describedby="upload-desc">
                                <span>Can upload</span>
                                <span id="upload-desc" class="visually-hidden">Allow user to upload artifacts</span>
                            </label>
                            <label>
                                <input type="checkbox" id="register-can-search" aria-describedby="search-desc">
                                <span>Can search</span>
                                <span id="search-desc" class="visually-hidden">Allow user to search for artifacts</span>
                            </label>
                            <label>
                                <input type="checkbox" id="register-can-download" aria-describedby="download-desc">
                                <span>Can download</span>
                                <span id="download-desc" class="visually-hidden">Allow user to download artifacts</span>
                            </label>
                            <label>
                                <input type="checkbox" id="register-is-admin" aria-describedby="admin-desc">
                                <span>Is admin (grants all permissions)</span>
                                <span id="admin-desc" class="visually-hidden">Administrator status grants all permissions</span>
                            </label>
                        </div>
                    </fieldset>
                    <div id="register-error" class="modal-error" style="display: none;" role="alert" aria-live="assertive"></div>
                    <div id="register-success" class="modal-success" style="display: none;" role="status" aria-live="polite"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button onclick="closeRegisterModal()" class="btn-secondary">Cancel</button>
                <button onclick="submitUserRegistration()" class="btn-primary" id="register-submit-btn">Register User</button>
            </div>
        </div>
    </div>


    <script src="scripts.js"></script>
</body>
</html>
